<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>WMS Tools - Dashboard</title>
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <div class="phone">
    <div class="screen">
      <header class="header">
        <div class="header-top">
          <a class="icon-btn" href="settings.html" aria-label="ParamÃ¨tres">âš™ï¸</a>
          <div class="title">Logo / DL Logistique <strong>Â©</strong></div>
          <div class="bell-wrap">
            <button class="icon-btn" aria-label="Notifications">ğŸ””</button>
            <div class="badge">3</div>
          </div>
        </div>
      </header>
      <div class="top-shortcuts" aria-label="Menu haut">
        <a href="settings.html">ParamÃ¨tres</a>
        <a href="history-updates.html">Historique des mises Ã  jour</a>
        <a href="help.html">Aide & support</a>
      </div>

      <main class="content">
        <section class="tiles">
          <a class="tile" id="tile-dashboard" href="consolidation.html">
            <div class="tile-icon icon-consolidation artwork-icon">
              <img src="assets/icons/consolidation-ios-dark.png" alt="Consolidation" />
            </div>
            <div class="label">Consolidation</div>
          </a>
          <a class="tile" id="tile-stock" href="stock.html">
            <div class="tile-icon blue">ğŸ“‹</div>
            <div class="label">Inventaire</div>
          </a>
          <a class="tile" id="tile-tasks" href="tasks.html">
            <div class="tile-icon icon-shipping artwork-icon">
              <img src="assets/icons/suivi-expedition-ios-dark.png" alt="Suivi ExpÃ©dition" />
            </div>
            <div class="label">Suivi ExpÃ©dition</div>
          </a>
          <a class="tile" href="remise.html">
            <div class="tile-icon artwork-icon">
              <img src="assets/icons/remise-ios-dark.png" alt="Remise en stock" />
            </div>
            <div class="label">Remise en Stock</div>
          </a>
          <a class="tile" id="tile-more" href="layout.html">
            <div class="tile-icon artwork-icon">
              <img src="assets/icons/layout-ios-dark.png" alt="Layout" />
            </div>
            <div class="label">Layout</div>
          </a>
          <a class="tile" href="reception.html">
            <div class="tile-icon artwork-icon">
              <img src="assets/icons/receiving-ios-dark.png" alt="RÃ©ception ASN" />
            </div>
            <div class="label">RÃ©ception ASN</div>
          </a>
        </section>

        <section class="report">
          <h3>Rapport entrepÃ´t</h3>
          <div class="report-grid single-chart">
            <div class="chart pie-card">
              <h4 id="chart-title">Commande et ExpÃ©dition - Laval</h4>
              <div class="pie-wrap">
                <div class="pie" id="dashboard-pie"></div>
                <ul class="legend" id="dashboard-legend"></ul>
              </div>
              <p class="warning-count" id="warning-count"></p>
            </div>
            <div class="location-strip" aria-label="Sites">
              <button class="location-pill active" type="button" data-site="laval">Laval</button>
              <button class="location-pill" type="button" data-site="5995">5995</button>
              <button class="location-pill" type="button" data-site="jarry">Jarry</button>
              <button class="location-pill" type="button" data-site="langelier">Langelier</button>
            </div>
          </div>

          <div class="mini-strip" aria-hidden="true">
            <div class="mini-card">ğŸŒ</div>
            <div class="mini-card">ğŸ“¦ğŸ“¦</div>
            <div class="mini-card">ğŸ“ˆ</div>
          </div>
        </section>
      </main>

      <nav class="tabbar" aria-label="Navigation principale">
        <a href="index.html" class="tab active"><span class="i">ğŸ </span><span>Dashboard</span></a>
        <a href="consolidation.html" class="tab"><span class="i tab-icon"><img src="assets/icons/consolidation-ios-dark.png" alt="" aria-hidden="true"></span><span>Consol.</span></a>
        <a href="tasks.html" class="tab"><span class="i tab-icon"><img src="assets/icons/suivi-expedition-ios-dark.png" alt="" aria-hidden="true"></span><span>Suivi</span></a>
        <a href="remise.html" class="tab"><span class="i tab-icon"><img src="assets/icons/remise-ios-dark.png" alt="" aria-hidden="true"></span><span>Remise</span></a>
        <a href="layout.html" class="tab"><span class="i tab-icon"><img src="assets/icons/layout-ios-dark.png" alt="" aria-hidden="true"></span><span>Layout</span></a>
        <a href="reception.html" class="tab"><span class="i tab-icon"><img src="assets/icons/receiving-ios-dark.png" alt="" aria-hidden="true"></span><span>RÃ©ception</span></a>
      </nav>
    </div>
  </div>

  <script>
    const siteData = {
      laval: {
        title: 'Commande et ExpÃ©dition - Laval',
        values: [13, 5, 12],
        labels: ['Tn Transit', 'ConsolidÃ©', 'PRÃ‰'],
        lowStock: 8,
      },
      '5995': {
        title: 'Commande et ExpÃ©dition - 5995',
        values: [9, 6, 14],
        labels: ['Tn Transit', 'ConsolidÃ©', 'PRÃ‰'],
        lowStock: 5,
      },
      jarry: {
        title: 'Commande et ExpÃ©dition - Jarry',
        values: [7, 10, 11],
        labels: ['Tn Transit', 'ConsolidÃ©', 'PRÃ‰'],
        lowStock: 11,
      },
      langelier: {
        title: 'Commande et ExpÃ©dition - Langelier',
        values: [15, 4, 8],
        labels: ['Tn Transit', 'ConsolidÃ©', 'PRÃ‰'],
        lowStock: 3,
      },
    };

    const colors = ['#64b94e', '#f0b336', '#2175cb'];
    const titleEl = document.getElementById('chart-title');
    const pieEl = document.getElementById('dashboard-pie');
    const legendEl = document.getElementById('dashboard-legend');
    const warningEl = document.getElementById('warning-count');
    const siteButtons = document.querySelectorAll('.location-pill');

    function renderChart(siteKey) {
      const data = siteData[siteKey];
      if (!data) return;

      titleEl.textContent = data.title;
      const total = data.values.reduce((sum, value) => sum + value, 0);
      let currentPercent = 0;
      const parts = data.values.map((value, index) => {
        const portion = (value / total) * 100;
        const start = currentPercent;
        const end = currentPercent + portion;
        currentPercent = end;
        return `${colors[index]} ${start}% ${end}%`;
      });
      pieEl.style.background = `conic-gradient(${parts.join(', ')})`;

      legendEl.innerHTML = data.values
        .map((value, index) => `<li><span class="dot" style="background:${colors[index]}"></span>${value} ${data.labels[index]}</li>`)
        .join('');

      warningEl.innerHTML = `<strong>${data.lowStock}</strong> Produits &lt; 20`;

      siteButtons.forEach((button) => {
        button.classList.toggle('active', button.dataset.site === siteKey);
      });
    }

    siteButtons.forEach((button) => {
      button.addEventListener('click', () => renderChart(button.dataset.site));
    });

    renderChart('laval');
  </script>
</body>
</html>
